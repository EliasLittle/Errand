<Function>
<Identifier("my_malloc_main")>
<LParen>
<RParen>
<Newline>
<Identifier("ptr")>
<Assignment>
<Identifier("malloc")>
<LParen>
<Int(4)>
<RParen>
<Newline>
<Newline>
<Identifier("_mem_store")>
<LParen>
<Identifier("ptr")>
<Comma>
<Int(0)>
<Comma>
<Int(42)>
<RParen>
<Newline>
<Newline>
<Identifier("printf")>
<LParen>
<StringLiteral("Pointer: %p\n")>
<Comma>
<Identifier("ptr")>
<RParen>
<Newline>
<Identifier("val")>
<Assignment>
<Identifier("_mem_load")>
<LParen>
<Identifier("ptr")>
<Comma>
<Int(0)>
<RParen>
<Newline>
<Identifier("printf")>
<LParen>
<StringLiteral("Value: %d\n")>
<Comma>
<Identifier("val")>
<RParen>
<Newline>
<Newline>
<Identifier("free")>
<LParen>
<Identifier("ptr")>
<RParen>
<Newline>
<Newline>
<Identifier("printf")>
<LParen>
<StringLiteral("Pointer after free: %p\n")>
<Comma>
<Identifier("ptr")>
<RParen>
<Newline>
<Identifier("printf")>
<LParen>
<StringLiteral("Use after free :O %d\n")>
<Comma>
<Identifier("_mem_load")>
<LParen>
<Identifier("ptr")>
<Comma>
<Int(0)>
<RParen>
<RParen>
<Newline>
<Newline>
<End>
<Newline>
<Newline>
<Identifier("my_malloc_main")>
<LParen>
<RParen>
